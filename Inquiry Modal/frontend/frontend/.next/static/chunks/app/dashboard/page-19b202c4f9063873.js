(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{966:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5155),s=r(2115),l=r(3464),o=r(4530),i=r(4822);let n=["All","Pending","Hold","Confirmed","Not Available","Released","Dispatched"];function d(){let[e,t]=(0,s.useState)("All"),[r,d]=(0,s.useState)([]),{notifications:c}=(0,i.h)(e=>e),h=c.filter(e=>{var t;return!((null==(t=e.dismissed_by)?void 0:t.length)>0)});(0,s.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("token"),t=await l.A.get("http://localhost:8000/inquiries",{headers:{Authorization:"Bearer ".concat(e)}});d(t.data)}catch(e){console.error("Failed to fetch inquiries:",e)}})()},[]);let b=r.length,x=r.filter(e=>{var t,r;return(null==(t=e.sale_team_status)?void 0:t.toLowerCase())==="hold"||(null==(r=e.sale_team_status)?void 0:r.toLowerCase())==="hold - toh"}).length,g=r.filter(e=>{var t,r;return(null==(t=e.sale_team_status)?void 0:t.toLowerCase())==="not available"||(null==(r=e.sale_team_status)?void 0:r.toLowerCase())==="on memo"}).length,u=r.filter(e=>{var t,r;return(null==(t=e.sale_team_status)?void 0:t.toLowerCase())==="release"||(null==(r=e.sale_team_status)?void 0:r.toLowerCase())==="released"}).length,m=r.filter(e=>{var t,r;return(null==(t=e.sale_team_status)?void 0:t.toLowerCase())==="dispatch"||(null==(r=e.sale_team_status)?void 0:r.toLowerCase())==="dispatched"}).length,p=(e,t)=>{if(!t)return!1;let r=t.toLowerCase();switch(e.toLowerCase()){case"pending":return"pending"===r;case"hold":return"hold"===r||"hold - toh"===r;case"confirmed":return"confirmed"===r||"confirmed - toh"===r;case"not available":return"not available"===r||"on memo"===r;case"released":return"release"===r||"released"===r;case"dispatched":return"dispatch"===r||"dispatched"===r;default:return!0}},y="all"===e.toLowerCase()?r:r.filter(t=>p(e,t.sale_team_status));return(0,a.jsxs)("div",{className:"p-4 sm:p-6 bg-white rounded-lg shadow-md",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"User"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"bg-blue-200 text-blue-900 rounded-lg p-6 flex flex-col items-center shadow",children:[(0,a.jsx)("span",{className:"text-lg",children:"Total Inquiries"}),(0,a.jsx)("span",{className:"text-3xl font-bold mt-2",children:b})]}),(0,a.jsxs)("div",{className:"bg-green-100 text-green-900 rounded-lg p-6 flex flex-col items-center shadow",children:[(0,a.jsx)("span",{className:"text-lg",children:"Hold Inquiries"}),(0,a.jsx)("span",{className:"text-3xl font-bold mt-2",children:x})]}),(0,a.jsxs)("div",{className:"bg-red-100 text-red-900 rounded-lg p-6 flex flex-col items-center shadow",children:[(0,a.jsx)("span",{className:"text-lg",children:"Not Available"}),(0,a.jsx)("span",{className:"text-3xl font-bold mt-2",children:g})]}),(0,a.jsxs)("div",{className:"bg-yellow-100 text-yellow-900 rounded-lg p-6 flex flex-col items-center shadow",children:[(0,a.jsx)("span",{className:"text-lg",children:"Released Items"}),(0,a.jsx)("span",{className:"text-3xl font-bold mt-2",children:u})]}),(0,a.jsxs)("div",{className:"bg-purple-200 text-purple-900 rounded-lg p-6 flex flex-col items-center shadow",children:[(0,a.jsx)("span",{className:"text-lg",children:"Dispatched Items"}),(0,a.jsx)("span",{className:"text-3xl font-bold mt-2",children:m})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow-lg border border-gray-100 max-h-[70vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Inquiry Status Overview"}),(0,a.jsx)("div",{className:"flex gap-4 mb-4 overflow-x-auto whitespace-nowrap",children:n.map(r=>(0,a.jsx)("button",{className:e.toLowerCase()===r.toLowerCase()?"text-blue-600 font-semibold border-b-2 border-blue-600 pb-1":"text-gray-500 hover:text-blue-600",onClick:()=>t(r),children:r},r))}),(0,a.jsx)("div",{className:"overflow-x-auto w-full h-[400px] max-h-[400px]",children:(0,a.jsxs)("table",{className:"min-w-full text-sm border border-gray-300",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-200",children:(0,a.jsxs)("tr",{className:"bg-gray-100 text-gray-700 text-left",children:[(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Inquiry ID"}),(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Stock ID"}),(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Shape"}),(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Type"}),(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Status"}),(0,a.jsx)("th",{className:"py-2 px-3 border border-gray-300",children:"Created By"})]})}),(0,a.jsxs)("tbody",{children:[y.map((e,t)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:e.id}),(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:e.stock_id||e.stockId}),(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:e.shape}),(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:e.type}),(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:(0,a.jsx)(o.A,{status:e.sale_team_status||"None"})}),(0,a.jsx)("td",{className:"py-2 px-3 border border-gray-300",children:e.sales||"N/A"})]},"".concat(e.inquiry_id||e.id,"-").concat(t))),0===y.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"text-center py-4 text-gray-400",children:"No inquiries found."})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg border border-gray-100",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"\uD83D\uDC8E DiamondFlow: How It Works"}),(0,a.jsxs)("p",{className:"text-sm text-gray-800",children:["\uD83D\uDC49 Start by logging in based on your role (Admin, Sales, Backend, Account), then add or update inquiries, upload invoices, and manage status.",(0,a.jsx)("br",{}),"\uD83D\uDE80 Use the tabs to view inquiries by status (Hold, Confirmed, Dispatch, etc.), and track updates through live notifications."]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg border border-gray-100 mb-6 h-full max-h-[100vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),0===h.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 h-[600px] max-h-[600px]",children:"No recent activity"}):(0,a.jsx)("ul",{className:"space-y-2 overflow-y-auto h-[600px] max-h-[600px]",children:h.map(e=>(0,a.jsxs)("li",{className:"border-l-4 border-blue-500 pl-3 text-sm text-gray-800 bg-blue-50 rounded p-2",children:[(0,a.jsx)("p",{children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.timestamp})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow block lg:hidden",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"\uD83D\uDC8E DiamondFlow: How It Works"}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:"\uD83D\uDC49 Start by logging in based on your role (Admin, Sales, Backend, Account), then add or update inquiries, upload invoices, and manage status. \uD83D\uDE80 Use the tabs to view inquiries by status (Hold, Confirmed, Dispatch, etc.), and track updates through live notifications."})]})]})]})]})}},4530:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(5155);r(2115);let s={pending:"bg-yellow-100 text-yellow-800 border border-yellow-300",hold:"bg-green-700 text-white","not available":"bg-red-100 text-red-700 border border-red-300","on memo":"bg-blue-100 text-blue-700 border border-blue-300","confirmed - toh":"bg-purple-700 text-white","hold - toh":"bg-orange-100 text-orange-700 border border-orange-300",release:"bg-red-700 text-white","added to stock":"bg-red-800 text-white","in exhibition":"bg-blue-100 text-blue-700 border border-blue-300",available:"bg-green-100 text-green-700 border border-green-300",released:"bg-red-700 text-white","sent to vendor":"bg-blue-800 text-white","from other":"bg-cyan-300 text-black","released, staging":"bg-red-800 text-white","own hk":"bg-green-800 text-white","own india":"bg-blue-700 text-white",surat:"bg-slate-700 text-white",mumbai:"bg-amber-800 text-white",loose:"bg-blue-700 text-white","in jewellery":"bg-purple-700 text-white",certified:"bg-pink-200 text-black",natural:"bg-green-700 text-white",rcvd:"bg-green-700 text-white","pending payment":"bg-red-700 text-white",aprvd:"bg-blue-900 text-white","half rcvd":"bg-yellow-200 text-yellow-900","transfer ss sent":"bg-green-100 text-green-800 border border-green-300",dispatched:"bg-blue-600 text-white",null:"bg-gray-100 text-gray-400 border border-gray-200",none:"bg-gray-100 text-gray-400 border border-gray-200",ok:"bg-green-600 text-white","blue tinge":"bg-blue-700 text-white","other tinge":"bg-purple-300 text-purple-900","culet broken":"bg-yellow-900 text-yellow-100","other issue":"bg-red-700 text-white","no bgm":"bg-yellow-200 text-yellow-900","stone - oh":"bg-blue-200 text-blue-900","cert - oh":"bg-purple-400 text-white","s & c both - on":"bg-blue-100 text-blue-900","mumbai hold - ready to dispatch":"bg-yellow-300 text-yellow-900",tommorow:"bg-lime-400 text-black","on the way":"bg-purple-200 text-purple-900","hk office":"bg-green-200 text-green-900","sent to vndr.":"bg-blue-700 text-white","fr other":"bg-cyan-400 text-black","released, sta":"bg-red-800 text-white",hongkong:"bg-blue-200 text-blue-900",usa:"bg-blue-100 text-blue-900",other:"bg-red-700 text-white"};function l(e){let{status:t,className:r=""}=e,l=s[(null!=t?t:"").trim().toLowerCase()]||"bg-gray-200 text-gray-700 border border-gray-300";return(0,a.jsx)("span",{className:"inline-block rounded px-2 py-0.5 text-xs font-semibold whitespace-nowrap ".concat(l," ").concat(r),children:t||"None"})}},4822:(e,t,r)=>{"use strict";r.d(t,{NotificationProvider:()=>i,h:()=>n});var a=r(5155),s=r(2115),l=r(6572);let o=(0,s.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)([]),[n,d]=(0,s.useState)(null),[c,h]=(0,s.useState)(null),b="".concat(l.A);(0,s.useEffect)(()=>{{let e=localStorage.getItem("role"),t=localStorage.getItem("userName"),r=localStorage.getItem("token");if(console.log("\uD83D\uDCE6 role from localStorage:",e),console.log("\uD83D\uDCE6 userName from localStorage:",t),e&&t){let r="".concat(e,"_").concat(t);console.log("✅ Setting userKey:",r),d(r)}else console.warn("❌ Missing role or userName in localStorage");r&&h(r)}},[]);let x=async()=>{if(n)try{let e=await fetch("".concat(b,"/notifications/visible-to/").concat(n));if(!e.ok)throw Error("Fetch failed");let t=await e.json();t.filter(e=>"add"===e.type),i(t)}catch(e){console.error("Failed to fetch notifications:",e)}},g=async(e,t)=>{if(c)try{await fetch("".concat(b,"/notifications/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify({message:e,visible_to:t})}),x()}catch(e){console.error("Failed to add notification:",e)}},u=async e=>{if(n&&c)try{await fetch("".concat(b,"/notifications/").concat(e,"/dismiss?user_key=").concat(n),{method:"POST",headers:{Authorization:"Bearer ".concat(c)}}),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to dismiss notification:",e)}};return(0,s.useEffect)(()=>{n?(console.log("\uD83D\uDD0D userKey for notifications:",n),x()):console.warn("⚠️ No userKey set — skipping fetchNotifications()")},[n]),(0,a.jsx)(o.Provider,{value:{notifications:r,fetchNotifications:x,addNotification:g,dismissNotification:u},children:t})},n=e=>{let t=(0,s.useContext)(o);if(!t)throw Error("useNotification must be used within NotificationProvider");return t}},6572:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a="https://excellentorders.in"},8343:(e,t,r)=>{Promise.resolve().then(r.bind(r,966))}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(8343)),_N_E=e.O()}]);