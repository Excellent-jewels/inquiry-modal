"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{3462:(e,t,r)=>{r.d(t,{u:()=>n});var a=r(9159);function n(){let e=localStorage.getItem("token");if(!e)return null;try{return(0,a.s)(e).role||null}catch(e){return console.error("Failed to decode token",e),null}}},4530:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155);r(2115);let n={pending:"bg-yellow-100 text-yellow-800 border border-yellow-300",hold:"bg-green-700 text-white","not available":"bg-red-100 text-red-700 border border-red-300","on memo":"bg-blue-100 text-blue-700 border border-blue-300","confirmed - toh":"bg-purple-700 text-white","hold - toh":"bg-orange-100 text-orange-700 border border-orange-300",release:"bg-red-700 text-white","added to stock":"bg-red-800 text-white","in exhibition":"bg-blue-100 text-blue-700 border border-blue-300",available:"bg-green-100 text-green-700 border border-green-300",released:"bg-red-700 text-white","sent to vendor":"bg-blue-800 text-white","from other":"bg-cyan-300 text-black","released, staging":"bg-red-800 text-white","own hk":"bg-green-800 text-white","own india":"bg-blue-700 text-white",surat:"bg-slate-700 text-white",mumbai:"bg-amber-800 text-white",loose:"bg-blue-700 text-white","in jewellery":"bg-purple-700 text-white",certified:"bg-pink-200 text-black",natural:"bg-green-700 text-white",rcvd:"bg-green-700 text-white","pending payment":"bg-red-700 text-white",aprvd:"bg-blue-900 text-white","half rcvd":"bg-yellow-200 text-yellow-900","transfer ss sent":"bg-green-100 text-green-800 border border-green-300",dispatched:"bg-blue-600 text-white",null:"bg-gray-100 text-gray-400 border border-gray-200",none:"bg-gray-100 text-gray-400 border border-gray-200",ok:"bg-green-600 text-white","blue tinge":"bg-blue-700 text-white","other tinge":"bg-purple-300 text-purple-900","culet broken":"bg-yellow-900 text-yellow-100","other issue":"bg-red-700 text-white","no bgm":"bg-yellow-200 text-yellow-900","stone - oh":"bg-blue-200 text-blue-900","cert - oh":"bg-purple-400 text-white","s & c both - on":"bg-blue-100 text-blue-900","mumbai hold - ready to dispatch":"bg-yellow-300 text-yellow-900",tommorow:"bg-lime-400 text-black","on the way":"bg-purple-200 text-purple-900","hk office":"bg-green-200 text-green-900","sent to vndr.":"bg-blue-700 text-white","fr other":"bg-cyan-400 text-black","released, sta":"bg-red-800 text-white",hongkong:"bg-blue-200 text-blue-900",usa:"bg-blue-100 text-blue-900",other:"bg-red-700 text-white"};function l(e){let{status:t,className:r=""}=e,l=n[(null!=t?t:"").trim().toLowerCase()]||"bg-gray-200 text-gray-700 border border-gray-300";return(0,a.jsx)("span",{className:"inline-block rounded px-2 py-0.5 text-xs font-semibold whitespace-nowrap ".concat(l," ").concat(r),children:t||"None"})}},5695:(e,t,r)=>{var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},6572:(e,t,r)=>{r.d(t,{A:()=>a});let a="https://excellentorders.in"},7153:(e,t,r)=>{r.d(t,{A:()=>y});var a=r(5155),n=r(2115),l=r(9946);let o=(0,l.A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),i=(0,l.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var s=r(4530);let c=["Loose","In Jewellery","Certified","Natural"],d=["Pending","Hold","Not Available","On Memo","Confirmed - TOH","Hold - TOH","Release","Added to Stock","In Exhibition","Dispatched"],u=["RCVD","Pending","APRVd","HALF RCVD","Transfer SS Sent","Null"],h=["OK","BLUE TINGE","OTHER TINGE","CULET BROKEN","OTHER ISSUE","NO BGM","Null"],b=["Stone - OH","Cert - OH","Pending","S & C BOTH - ON","Mumbai Hold - Ready to Dispatch","Tomorrow","On the Way","HK Office","Null"],p=["Available","Not Available","Released","Sent to Vndr.","Fr Other","Released, Sta","Own HK","Own India","Surat","Mumbai","Null"],x=["Surat","Mumbai","Hongkong","USA","Other","Null"];function g(e){let{options:t,value:r,onChange:n,open:l,setOpen:o,id:i,colKey:c}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{style:{cursor:"pointer",display:"inline-block"},onClick:()=>o(l==="".concat(c,"-").concat(i)?null:"".concat(c,"-").concat(i)),children:(0,a.jsx)(s.A,{status:r})}),l==="".concat(c,"-").concat(i)&&(0,a.jsx)("div",{className:"absolute z-10 bg-gray-50 border border-gray-300 shadow-md mt-2 left-1/2 -translate-x-1/2 min-w-[160px] text-left",style:{minWidth:160},children:t.map(e=>(0,a.jsx)("div",{className:"p-2 pl-2 hover:bg-gray-100 cursor-pointer flex items-center",onClick:()=>{n(e),o(null)},children:(0,a.jsx)(s.A,{status:e})},e))})]})}var m=r(6572);function y(e){let{data:t,columns:r,onDelete:l,onEdit:y,onCheckboxChange:k,onSelectAll:w,defaultAvailability:f="PENDING",rowCheckbox:v=!1,selectedRows:j=[],onRowCheckbox:N,onSelectAllRows:S,role:C,showInvoiceColumn:A=!1,pageType:O="sales",showBillColumn:R=!1}=e,{role:_}=function(){let[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("role");e&&t(e),a(!1)},[]),{role:e,loading:r}}(),[I,E]=(0,n.useState)(null),[H,L]=(0,n.useState)(null),[T,q]=(0,n.useState)({}),[P,F]=(0,n.useState)([]),[M,D]=(0,n.useState)({}),U={admin:r.map(e=>e.key),sales:r.map(e=>e.key).filter(e=>["inquiry_id","inq_date","today_date","period","sales","buyer","stockId","shape","ct","color","clarity","cut","po","sym","lab","report","disPpc","ppc","amt","type","availability","payment","remark"].includes(e)),backend:["location","otRemark","time","statusOfStone","qcRemark","stoneConfirmationRemark","entryStatus","locationRemark"],account:[]},V=_&&U[_]?U[_]:[],W=e=>{let r=t.find(t=>t.id===e);(null==r?void 0:r.sale_team_status)!=="Dispatched"&&(L(e),q(r?{...r}:{}))},$=()=>{y&&H&&y(H,{...T,id:H}),L(null),q({})},B=()=>{L(null),q({})},K=e=>["type","availability","payment","qcRemark","statusOfStone","otRemark","location"].includes(e),z=e=>"sales"===_&&["type","availability","payment"].includes(e)||"backend"===_&&["qcRemark","statusOfStone","otRemark","location"].includes(e)||"admin"===_&&K(e),G=e=>{switch(e){case"type":return c;case"availability":return d;case"payment":return u;case"qcRemark":return h;case"statusOfStone":return b;case"otRemark":return p;case"location":return x;default:return[]}};t.length>0&&t.every(e=>j.includes(e.id));let J=e=>{let{color:t="#325c85"}=e;return(0,a.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"none",stroke:t,strokeWidth:"2"}),(0,a.jsx)("path",{d:"M8 12h8M8 12l4-4m-4 4l4 4",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),(0,a.jsx)("polyline",{points:"16 3 21 3 21 8",stroke:t,strokeWidth:"2",fill:"none"})]})};return(0,a.jsx)("div",{className:"overflow-x-auto bg-white shadow h-[calc(80vh-180px)] max-h-screen",children:(0,a.jsxs)("table",{className:"min-w-[1800px] w-full text-xs border border-gray-300",children:[(0,a.jsx)("thead",{className:"sticky top-0 z-100 bg-gray-200 border-b border-gray-300",children:(0,a.jsxs)("tr",{className:"text-gray-700",children:[v&&(0,a.jsx)("th",{className:"py-2 px-3 font-semibold border border-gray-300 text-center whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:t.length>0&&t.every(e=>j.includes(e.id)),onChange:e=>S&&S(e.target.checked)})}),A&&["admin","sales","account"].includes(C)&&(0,a.jsx)("th",{className:"py-3 px-3 border border-gray-300 text-center align-middle",children:"Invoice"}),(0,a.jsx)("th",{className:"py-2 px-3 font-semibold border border-gray-300 text-center whitespace-nowrap",children:"Inquiry ID"}),r.map(e=>(0,a.jsx)("th",{className:"py-2 px-3 font-semibold border border-gray-300 text-center whitespace-nowrap",children:e.label},e.key)),l&&(0,a.jsx)("th",{className:"py-2 px-3 font-semibold border border-gray-300",children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[0===t.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:r.length+(l?2:1)+ +!!v,className:"text-center py-4 text-gray-400 border border-gray-200 whitespace-nowrap",children:"No inquiries found."})}),t.map(e=>{let t=H===e.id;return(0,a.jsxs)("tr",{children:[v&&(0,a.jsx)("td",{className:"py-3 px-3 border border-gray-200 text-center align-middle whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:j.includes(e.id),onChange:t=>N&&N(e.id,t.target.checked)})}),A&&["admin","sales","account"].includes(C)&&(0,a.jsx)("td",{className:"py-3 px-3 border border-gray-200 text-center align-middle whitespace-nowrap",children:["admin","sales"].includes(C)?(0,a.jsxs)("form",{onSubmit:async t=>{var r;t.preventDefault();let a=t.currentTarget.elements.namedItem("invoiceFile");if(!(null==(r=a.files)?void 0:r[0]))return;let n=a.files[0],l=new FormData;l.append("invoice",n),l.append("inquiry_id",e.inquiry_id),await fetch("".concat(m.A,"/inquiries/upload-invoice"),{method:"POST",body:l}),alert("Invoice uploaded!"),window.location.reload()},children:[(0,a.jsx)("input",{type:"file",name:"invoiceFile",accept:".pdf,.jpg,.png",style:{display:"none"},id:"invoice-file-".concat(e.id),onChange:e=>{var t;return null==(t=e.currentTarget.form)?void 0:t.requestSubmit()}}),(0,a.jsx)("label",{htmlFor:"invoice-file-".concat(e.id),style:{cursor:"pointer"},children:(0,a.jsx)(J,{})}),e.invoice_file?(0,a.jsx)("a",{href:"".concat(m.A,"/uploaded_invoices/").concat(e.invoice_file),target:"_blank",rel:"noopener noreferrer",className:"block mt-1 text-blue-500 text-xs underline",children:"View Invoice"}):(0,a.jsx)("span",{className:"block mt-1 text-gray-400 text-xs",children:"No file"})]}):e.invoice_file?(0,a.jsx)("a",{href:"".concat(m.A,"/uploaded_invoices/").concat(e.invoice_file),target:"_blank",rel:"noopener noreferrer",className:"block text-blue-500 text-xs underline",children:"View Invoice"}):(0,a.jsx)("span",{className:"block text-gray-400 text-xs",children:"No file"})}),(0,a.jsx)("td",{className:"py-3 px-3 border border-gray-200 text-center align-middle whitespace-nowrap",children:"backend"===O?e.inquiry_id:e.id}),r.map(r=>{var n;let l=V.includes(r.key)&&"dispatch"!==e.sale_team_status,o=K(r.key),i=z(r.key),c=G(r.key),d=null!=(n=e[r.key])?n:"";return(0,a.jsx)("td",{className:"py-3 px-3 border border-gray-200 text-center align-middle whitespace-nowrap",style:{position:"relative",minHeight:64},children:i&&"Dispatched"!==e.sale_team_status?(0,a.jsx)(g,{options:c,value:d,onChange:t=>k&&k(e.id,r.key,t),open:I,setOpen:E,id:e.id,colKey:r.key}):t&&l?"FALSE"===r.label?(0,a.jsx)("input",{type:"checkbox",checked:!!T[r.key],onChange:e=>q(t=>({...t,[r.key]:e.target.checked})),className:"accent-blue-500"}):o?(0,a.jsx)(g,{options:c,value:T[r.key]||"",onChange:e=>q(t=>({...t,[r.key]:e})),open:I,setOpen:E,id:e.id,colKey:r.key}):(0,a.jsx)("input",{type:"text",value:T[r.key]||"",onChange:e=>q(t=>({...t,[r.key]:e.target.value})),className:"border px-2 py-1 rounded w-full"}):"FALSE"===r.label?(0,a.jsx)("input",{type:"checkbox",checked:!!e[r.key],onChange:t=>k&&k(e.id,r.key,t.target.checked),className:"accent-blue-500"}):o?(0,a.jsx)(s.A,{status:d||"None"}):d},r.key)}),l&&(0,a.jsx)("td",{className:"py-3 px-3 border border-gray-200 text-center whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex justify-center gap-2",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"text-green-600 font-semibold px-2",onClick:$,children:"Save"}),(0,a.jsx)("button",{className:"text-gray-500 font-semibold px-2",onClick:B,children:"Cancel"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"text-blue-500",onClick:()=>W(e.id),children:(0,a.jsx)(o,{className:"w-5 h-5"})}),(0,a.jsx)("button",{className:"text-red-500",onClick:()=>l&&l(e.id),children:(0,a.jsx)(i,{className:"w-5 h-5"})})]})})})]},e.id)})]})]})})}},9159:(e,t,r)=>{r.d(t,{s:()=>n});class a extends Error{}function n(e,t){let r;if("string"!=typeof e)throw new a("Invalid token specified: must be a string");t||(t={});let n=+(!0!==t.header),l=e.split(".")[n];if("string"!=typeof l)throw new a(`Invalid token specified: missing part #${n+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(l)}catch(e){throw new a(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new a(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}a.prototype.name="InvalidTokenError"},9946:(e,t,r)=>{r.d(t,{A:()=>u});var a=r(2115);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},s=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:h,...b}=e;return(0,a.createElement)("svg",{ref:t,...c,width:n,height:n,stroke:r,strokeWidth:o?24*Number(l)/Number(n):l,className:i("lucide",d),...!u&&!s(b)&&{"aria-hidden":"true"},...b},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:s,...c}=r;return(0,a.createElement)(d,{ref:l,iconNode:t,className:i("lucide-".concat(n(o(e))),"lucide-".concat(e),s),...c})});return r.displayName=o(e),r}}}]);