(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2353:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},2961:(e,t,o)=>{Promise.resolve().then(o.bind(o,4822)),Promise.resolve().then(o.t.bind(o,2353,23)),Promise.resolve().then(o.t.bind(o,7275,23)),Promise.resolve().then(o.t.bind(o,9324,23))},4822:(e,t,o)=>{"use strict";o.d(t,{NotificationProvider:()=>n,h:()=>c});var a=o(5155),i=o(2115),r=o(6572);let s=(0,i.createContext)(void 0),n=e=>{let{children:t}=e,[o,n]=(0,i.useState)([]),[c,l]=(0,i.useState)(null),[f,d]=(0,i.useState)(null),h="".concat(r.A);(0,i.useEffect)(()=>{{let e=localStorage.getItem("role"),t=localStorage.getItem("userName"),o=localStorage.getItem("token");if(console.log("\uD83D\uDCE6 role from localStorage:",e),console.log("\uD83D\uDCE6 userName from localStorage:",t),e&&t){let o="".concat(e,"_").concat(t);console.log("✅ Setting userKey:",o),l(o)}else console.warn("❌ Missing role or userName in localStorage");o&&d(o)}},[]);let u=async()=>{if(c)try{let e=await fetch("".concat(h,"/notifications/visible-to/").concat(c));if(!e.ok)throw Error("Fetch failed");let t=await e.json();t.filter(e=>"add"===e.type),n(t)}catch(e){console.error("Failed to fetch notifications:",e)}},m=async(e,t)=>{if(f)try{await fetch("".concat(h,"/notifications/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(f)},body:JSON.stringify({message:e,visible_to:t})}),u()}catch(e){console.error("Failed to add notification:",e)}},_=async e=>{if(c&&f)try{await fetch("".concat(h,"/notifications/").concat(e,"/dismiss?user_key=").concat(c),{method:"POST",headers:{Authorization:"Bearer ".concat(f)}}),n(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to dismiss notification:",e)}};return(0,i.useEffect)(()=>{c?(console.log("\uD83D\uDD0D userKey for notifications:",c),u()):console.warn("⚠️ No userKey set — skipping fetchNotifications()")},[c]),(0,a.jsx)(s.Provider,{value:{notifications:o,fetchNotifications:u,addNotification:m,dismissNotification:_},children:t})},c=e=>{let t=(0,i.useContext)(s);if(!t)throw Error("useNotification must be used within NotificationProvider");return t}},6572:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});let a="https://excellentorders.in"},7275:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9324:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[519,441,684,358],()=>t(2961)),_N_E=e.O()}]);